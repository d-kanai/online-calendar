Feature: 参加者の上限
  会議には 50 名まで参加者を招待できるようにしたい
  そうすることで組織のポリシーを守れる

  Rule: 参加者数制限ポリシー
    1つの会議の参加者数は最大50名まで
    上限を超える参加者追加は拒否される
    組織のリソース管理とパフォーマンス維持のため

  Scenario: 上限に達していない場合に参加者を追加できる
    Given 会議に 49 名の参加者がいる
    When オーナーが新しい参加者 "user50@example.com" を追加する
    Then 参加者数は 50 名になる

  Scenario: 上限を超える参加者を追加しようとするとエラーになる
    Given 会議に 50 名の参加者がいる
    When オーナーが新しい参加者 "user51@example.com" を追加する
    Then エラー "参加者は50名までです" が発生する

Rule: 参加者の重複防止
  同じメールアドレスの参加者は一度だけ追加できる
  オーナー自身を参加者として追加することはできない

  Scenario: 既存参加者と同じメールアドレスでの追加を拒否
    Given 会議に "existing@example.com" が既に参加している
    When オーナーが "existing@example.com" を再度追加しようとする
    Then エラー "この参加者は既に追加されています" が発生する
    And 参加者数は変更されない

  Scenario: オーナーが自分自身を参加者として追加することを拒否
    Given オーナー "owner@example.com" が会議を作成している
    When オーナーが "owner@example.com" を参加者として追加しようとする
    Then エラー "この参加者は既に追加されています" が発生する
    And オーナーは参加者リストに表示されない

  Scenario: 大文字小文字を区別しない重複チェック
    Given 会議に "User@Example.Com" が既に参加している
    When オーナーが "user@example.com" を追加しようとする
    Then エラー "この参加者は既に追加されています" が発生する
