appId: dkanai.OnlineCalendar
env:
  API_URL: "http://localhost:3001"
---
# 会議機能のE2Eテスト

# ========================================
# Test 1: 会議一覧表示
# ========================================

# Given: 認証済み状態でアプリを起動
- runFlow: ../flows/launch_bypass_signin.yaml

# And: テスト用の会議が存在する
- runScript:
    file: ../scripts/setup_test_data.js
    env:
      API_URL: ${API_URL}
      TABLE: "meeting"
      DATA: '{"title": "E2Eテスト会議", "ownerId": "e2e-test-user"}'

# When: 会議タブに移動
- tapOn: "会議"

# Then: 会議一覧画面が表示される
- assertVisible: "会議一覧"

# When: 会議一覧を更新（プルトゥリフレッシュ）
- swipe:
    start: 50%, 30%
    end: 50%, 80%
    duration: 100

# Then: 作成した会議が表示される
- assertVisible: "E2Eテスト会議"

# ========================================
# Test 2: 会議作成
# ========================================

# When: 会議作成モーダルを開く
- tapOn:
    id: "addMeetingButton"

# Then: モーダルが表示される
- assertVisible: "新規会議作成"

# When: タイトルを入力
- tapOn:
    id: "titleField"
- inputText: "定例MTG"

# And: 作成ボタンをタップ
- tapOn: "作成"

# Then: 会議が正常に作成される
- assertVisible: "定例MTG"
